# CloudOps Agent – System Architecture

## 1. Overview

CloudOps Agent is an AI-driven automation platform designed to improve IT support operations in an enterprise environment.  
It integrates ServiceNow, AWS Bedrock, AWS Lambda, Amazon S3, Amazon DynamoDB, and Microsoft Teams to provide:

- automated knowledge base recommendations,  
- intelligent root cause analysis,  
- recurring issue detection,  
- AI-generated incident test data,  
- real-time notifications for support teams.

The system uses serverless architecture on AWS and applies secure prompt engineering practices, anonymization, and guardrails to ensure responsible and safe AI usage.


---

## 2. High-Level Architecture Diagram

The CloudOps Agent follows a serverless, event-driven design.  
ServiceNow triggers AWS automation workflows, AI modules perform analysis, and Microsoft Teams delivers final insights to support engineers.

ServiceNow
│
▼
[Outbound REST Message]
│
▼
Amazon API Gateway
│
▼
AWS Lambda – Core Processing
│ ├── DynamoDB (ticket history)
│ └── S3 (AI test incidents, logs)
▼
AI Layer (AWS Bedrock)
├── Smart KB Finder
├── User Insight Engine
├── AI Ticket Generator
└── Bias & Confidence Filter
▼
Microsoft Teams Webhook Notifications


**Description:**

- **ServiceNow** provides ticket data via a REST integration.
- **API Gateway** validates and forwards events.
- **AWS Lambda** enriches data, performs anonymization, and orchestrates AI calls.
- **Bedrock models** generate insights such as KB suggestions, root-cause predictions, and recurring issue flags.
- **Microsoft Teams** receives the final automated output for the support team.
- **S3 and DynamoDB** are used for storage, analytics, and AI training/test data.

---
---

## 3. Component Descriptions

This section describes the main components of the CloudOps Agent and their roles within the system.

### 3.1 ServiceNow (Trigger Layer)
ServiceNow acts as the starting point of the workflow.  
When an incident or request is created or updated, ServiceNow sends an outbound REST message containing ticket metadata.

Key responsibilities:
- Providing real-time ticket events  
- Sending structured JSON payloads  
- Integrating with AWS via REST API  

---

### 3.2 Amazon API Gateway (Integration Layer)
API Gateway receives requests directly from ServiceNow and acts as the secure entry point into AWS.

Responsibilities:
- Request validation  
- Input schema enforcement  
- Throttling and rate limiting  
- Forwarding events to AWS Lambda  

---

### 3.3 AWS Lambda – Core Processing Engine
The Lambda function orchestrates all logic inside AWS.  
It enriches the incoming data, applies security measures, and routes the event to the correct AI module.

Responsibilities:
- Data enrichment and normalization  
- PII anonymization before sending to Bedrock  
- Event classification (incident type, category)  
- Logging (CloudWatch)  
- Interaction with DynamoDB and S3  

---

### 3.4 Amazon DynamoDB (History & Analytics Store)
DynamoDB stores ticket history and user-specific patterns.

Use cases:
- Recurring issue detection  
- Correlating patterns across 30/60/180-day windows  
- Fast retrieval for AI context  

---

### 3.5 Amazon S3 (Storage for AI-Generated Data)
S3 stores synthetic test incidents generated by AI and any auxiliary data needed for evaluation or testing.

Use cases:
- Self-evolving demo environment  
- Replayable test scenarios  
- Logs and model outputs  

---

### 3.6 AWS Bedrock – AI Layer
The AI layer consists of several Bedrock-based modules:

#### • Smart KB Finder  
Suggests the most relevant knowledge base article based on embeddings.

#### • User Insight Engine  
Detects patterns in historical incidents and signals recurring problems.

#### • AI Ticket Generator  
Creates synthetic incidents for testing and demonstration purposes.

#### • Bias & Confidence Filter  
Ensures that only high-confidence and safety-verified AI outputs are sent to end users.

---

### 3.7 Microsoft Teams – Notification Layer
Teams is the final delivery channel for insights generated by the CloudOps Agent.

Responsibilities:
- Sending AI-powered recommendations  
- Presenting KB links, root-cause suggestions, and confidence scores  
- Delivering real-time alerts for support engineers  

---
---

## 4. Data Flow (Step-by-Step)

This section describes the full end-to-end flow of how data moves through the CloudOps Agent system, from ServiceNow to Microsoft Teams.

### Step 1 — Ticket Event in ServiceNow
A user creates or updates an incident or request in ServiceNow.  
An outbound REST message is triggered automatically.

Payload includes:
- ticket ID  
- short description  
- category  
- assignment group  
- configuration item (CI)  
- caller/user details  

---

### Step 2 — API Gateway Receives the Request
ServiceNow sends the JSON payload to **Amazon API Gateway**.  
API Gateway performs:

- input validation  
- rate limiting  
- request authentication  
- forwarding the event to Lambda  

---

### Step 3 — Lambda Core Engine Processing
The event enters the **AWS Lambda Core Processing Engine**.

Lambda performs:
- data normalization  
- removal or masking of sensitive data (PII anonymization)  
- classification of the ticket type  
- lookup of ticket history from DynamoDB  
- preparation of context for the AI modules  

Lambda then forwards the prepared prompt to the AI layer (Bedrock).

---

### Step 4 — AI Layer Generates Insights
The AI Layer (AWS Bedrock) processes the request using specialized modules:

- **Smart KB Finder** → finds relevant knowledge base articles  
- **User Insight Engine** → detects recurring patterns and user history  
- **AI Ticket Generator** → optional synthetic incident generation  
- **Bias & Confidence Filter** → validates the result and filters unsafe outputs  

Outputs include:
- KB recommendation  
- confidence score  
- root-cause suggestion  
- recurrence flag  
- optional synthetic incident  

---

### Step 5 — Store Data in DynamoDB & S3
Depending on the event type:

- Processed history is saved in **DynamoDB**  
- AI-generated incidents or logs are stored in **S3**  

This enables long-term analytics, trend detection, and demo automation.

---

### Step 6 — Notification Sent to Microsoft Teams
The final AI-enriched result is sent to the support team via a **Microsoft Teams Webhook**.

The message may include:
- recommended KB article  
- reason/explanation (in plain language)  
- confidence level  
- recurring issue detection  
- predicted root cause  

---

### Step 7 — (Optional) Dashboard Display
If the Vultr dashboard is enabled, logs and metrics (MTTR, recurring issues, KB hit rate) are displayed in real time.

---
---

## 5. Security Architecture

Security is a core design principle of the CloudOps Agent.  
The system applies multiple protection layers across data flow, AI inference, storage, and output delivery.  
This ensures compliance with organizational policies and prevents misuse of AI-generated content.

---

### 5.1 Data Protection & Encryption

All data processed by CloudOps Agent is protected using AWS native security controls:

- **Encryption in transit:** HTTPS/TLS between ServiceNow → API Gateway → Lambda → Teams  
- **Encryption at rest:**  
  - S3 buckets (SSE-S3 or SSE-KMS)  
  - DynamoDB tables (AWS KMS)  
- **IAM Roles with Least Privilege:**  
  Each component (Lambda, API Gateway, S3, DynamoDB) receives only the permissions it strictly needs.

These measures prevent unauthorized access and ensure data confidentiality.

---

### 5.2 PII Redaction & Anonymization

Before any data is sent to AI models (Bedrock), Lambda applies anonymization:

- removal of names and emails  
- masking of ticket IDs  
- stripping internal identifiers not required for inference  
- replacing sensitive text patterns with placeholders (e.g., `<USER>`, `<EMAIL>`, `<DEVICE>`)

This follows Responsible AI practices and reduces the risk of exposing personal or confidential data.

---

### 5.3 Bedrock Guardrails & Safe Prompt Engineering

The AI layer uses **Bedrock Guardrails** to enforce:

- protected topic filters  
- toxic output prevention  
- safe vocabulary policies  
- contextual constraints for IT support use cases  
- prevention of hallucinated actions ("reset password", "run cmd", etc.)

Prompts are structured using **secure prompt engineering**, so the model never receives privileged or raw sensitive data.

---

### 5.4 OWASP Top 10 for LLMs Mitigation

CloudOps Agent is protected against threats described in OWASP Top 10 for LLMs:

- **Prompt Injection Defense:**  
  Sanitization of user-provided text + static prompt templates  
- **Data Leakage Prevention:**  
  Restricted input fields + anonymization  
- **Model Hallucination Control:**  
  Confidence threshold + Bias & Confidence Filter  
- **Overreliance Protection:**  
  Human-in-the-loop: engineers validate outputs  
- **Output Injection Filtering:**  
  Sanitization of links, special characters, and model-generated content

---

### 5.5 Auditing & Logging

The system generates a detailed audit trail for security and transparency:

- **CloudTrail logs:** AWS API calls, Lambda invocations  
- **CloudWatch logs:** prompt/response IDs, error tracking  
- **DynamoDB logs:** historical event patterns  
- **Dashboard logs (optional Vultr):** metrics and anomaly detection  

This enables full traceability of AI decisions and supports post-incident analysis.

---

### 5.6 Access Control & Isolation

- No inbound ports, no servers → serverless isolation  
- API Gateway requires IAM or API key-based authentication  
- No direct access from the internet to any storage  
- AI models do not store or reuse user data (stateless inference)

---

### 5.7 Summary

CloudOps Agent implements a security-first architecture combining:

- encryption  
- anonymization  
- guardrails  
- serverless isolation  
- multi-layer audit logging  
- LLM safety controls  

This ensures safe and compliant use of AI in enterprise IT support workflows.

---
---

## 6. AI Modules

The CloudOps Agent AI layer is built on top of AWS Bedrock and consists of specialized, self-contained modules.  
Each module handles a specific analytical task and contributes to reducing MTTR, improving accuracy, and automating decision-making in IT support workflows.

---

### 6.1 Smart KB Finder

The Smart KB Finder recommends the most relevant knowledge base article for a given incident.

Key capabilities:
- Converts ticket text into vector embeddings  
- Performs semantic matching across KB articles  
- Ranks and scores top KB candidates  
- Returns:
  - KB ID  
  - title  
  - confidence score  
  - short explanation (“why this KB was selected”)  

Benefits:
- Faster incident resolution  
- Consistent KB usage across teams  
- Reduces L1/L2 guesswork

---

### 6.2 User Insight Engine (Recurring Issue Detector)

This module analyzes historical ticket data (30/60/180 days) and detects patterns associated with recurring issues.

Examples:
- repeated VPN timeout incidents  
- recurring certificate issues (SLS / Zscaler)  
- multiple Teams/Outlook disruptions  
- device-specific error patterns  

Outputs:
- recurrence count  
- detected pattern type  
- prediction of likely root cause  
- recommended action (“escalate / reimage / profile cleanup”)  

Benefits:
- Early detection of systemic issues  
- Reduced noise in L1 queues  
- Acceleration of proper escalation paths

---

### 6.3 Root Cause Suggestion Engine (Predictive Analysis)

(Part of the AI layer, internally used)

Tasks:
- analyzes context + user history  
- predicts the most probable root-cause category:
  - network  
  - authentication  
  - profile/certificate  
  - hardware  
  - application configuration  

Outputs include:
- root cause label  
- confidence score  
- short natural-language explanation  

Benefits:
- Better decision-making for L1/L2  
- Faster triage  
- Higher first-contact-resolution (FCR)

---

### 6.4 AI Ticket Generator (Synthetic Incident Creation)

This module generates realistic synthetic incidents, which makes the demo fully autonomous without depending on real customer data.

Common generated incident types:
- VPN connection timeout  
- Outlook crash after wake-from-sleep  
- Teams login loop  
- SAP GUI SLS certificate failure  
- Mapped drive not accessible  
- Zscaler policy mismatch  

Usage:
- stored in S3  
- periodically triggers the full automation pipeline  
- enables a self-testing and self-evolving demo environment  

Benefits:
- Safe testing environment (no PII)  
- Continuous integration-style pipeline  
- Reproducible incident scenarios  

---

### 6.5 Bias & Confidence Filter

This module validates AI outputs to ensure they meet quality and safety criteria.

Role:
- filters out low-confidence predictions  
- detects overfitting/underfitting patterns  
- enforces minimum confidence threshold (default: 0.79)  
- verifies that the output does not violate any safety rules (Guardrails)  
- rejects hallucinated KB IDs or unsupported actions  

Benefits:
- improved reliability of AI suggestions  
- prevents errors caused by hallucinations  
- ensures fairness in AI decision-making  

---

### 6.6 Prompt Layer (Template-Based Inference)

All prompts sent to AI models follow strict templates to ensure predictable behavior.

Features:
- structured prompt templates  
- context-limited ticket summaries  
- no access to raw sensitive data  
- consistency across all AI calls  

Benefits:
- safer AI generations  
- easier debugging  
- repeatable, deterministic inference patterns  

---

### 6.7 Summary

The AI layer of CloudOps Agent is modular, explainable, and optimized for enterprise-grade IT support workflows.  
It combines semantic search, predictive analytics, anomaly detection, and synthetic data generation to significantly accelerate and improve the handling of support tickets.

---
---

## 7. Metrics & KPIs

CloudOps Agent focuses on measurable operational improvements across IT support workflows.  
This section defines the key metrics (KPIs) used to evaluate system performance, AI accuracy, and overall business impact.

---

### 7.1 Operational Efficiency Metrics

These metrics measure how the system improves daily operations within IT support teams.

#### • MTTR (Mean Time to Resolve)
Tracks how quickly incidents are resolved.
- Faster resolution through AI-assisted triage  
- KB recommendations reduce diagnosis time  

**Goal:** MTTR ↓ by 15–40%

---

#### • AHT (Average Handling Time)
Measures the average time an engineer spends on a ticket.

Automation reduces:
- manual investigation  
- repeated lookups  
- back-and-forth communication  

**Goal:** AHT ↓ by 10–25%

---

#### • FCR (First Contact Resolution)
Percentage of tickets resolved in the first interaction.

Direct benefits from:
- KB suggestions  
- root-cause predictions  
- recurring issue flags  

**Goal:** FCR ↑ by 10–20%

---

### 7.2 AI Performance Metrics

These KPIs measure how accurate and reliable the AI layer is.

#### • KB Recommendation Accuracy
Percentage of correct knowledge base matches.

Measured by:
- engineer feedback  
- category-level hit rates  

**Goal:** Accuracy ≥ 80%

---

#### • Confidence Distribution
Tracks how confident the AI is across predictions.

Used to:
- tune confidence thresholds  
- detect outliers  
- adjust prompting and guardrails  

---

#### • False Positive Rate (FPR)
Cases where AI returned an incorrect KB or prediction with high confidence.

**Goal:** FPR ≤ 10%

---

#### • Recurring Issue Detection Accuracy
How often the system correctly identifies repeated patterns (e.g., VPN, certs, Teams, SAP).

**Goal:** ≥ 85% correct pattern detection

---

### 7.3 System Reliability Metrics

#### • End-to-End Latency
Time from ServiceNow trigger → Teams notification.

Target:
- **< 3 seconds** for standard requests  
- **< 6 seconds** for AI-heavy analysis  

---

#### • Pipeline Success Rate
Percentage of successful runs without errors.

Target:
- **≥ 99%**

---

### 7.4 Business-Level KPIs

These KPIs measure how CloudOps Agent impacts overall service quality.

#### • CSAT (Customer Satisfaction)
Indirectly increased through:
- faster resolution  
- consistent KB usage  
- reduced ticket bounce  

**Goal:** CSAT ↑ by 5–10%

---

#### • Self-Healed Tickets Percentage
How many incidents are fully automated without human contact, thanks to:
- AI Ticket Generator  
- recurring issue detection  
- knowledge automation  

**Goal:** Self-healed percentage ↑ over time

---

### 7.5 Reporting & Dashboards

All KPIs can be visualized in the optional **CloudOps Dashboard (Vultr)**:

- heatmaps of recurring issues  
- KB usage analytics  
- agent performance metrics  
- AI confidence trends  
- MTTR / AHT over time  

---

### 7.6 Summary

Metrics and KPIs allow CloudOps Agent to demonstrate clear improvements in:
- resolution speed  
- decision accuracy  
- support consistency  
- user satisfaction  

They help validate the value of AI automation in enterprise IT support and guide further optimization.

---
